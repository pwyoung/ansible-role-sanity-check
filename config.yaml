---
# NOTES:
#   - Overrides:
#     Some features are not shown here because they're likely to be the sort
#     of thing you'd only want to override locally.
#     See overrides.yaml.BAK for details.

generic:
  # If null or "", use the git top-level directory
  project_namespace: null

vagrant:
  boxes:
    - name: k-1
    - name: k-2
    - name: k-3
  global:
    memory: 4096
    cpus: 4
    boot_timeout: 300
    # Virtualbox only supports one NVME disk controller.
    # Implications:
    #   - Load will stress one disk controller which is not accurate
    #     (or desirable) compared to a system with two controllers.
    #   - NVME devices are named differently:
    #       Virtualbox: /dev/nvme0n1, /dev/nvme0n2, etc.
    #       libvirt:    /dev/nvme0n1, /dev/nvme1n1, etc.
    nvme_disks:
      data:
        size: 102401
      data2:
        size: 102401
    virtualbox_cfg:
      enabled: True # If not true then omit from Vagrantfile
      box: 'generic/ubuntu1804'
      enable_sse4: true
      nvme_disk_postfix: 'vdi' # can be vdi, vmdk, vhd
      nvme_disk_path: '.vagrant/nvme_disks/' # Default to a path relative to the Vagrantfile (common for VirtualBox)
      #nvme_disk_path: '/some-absolute-path/' # May be useful
      #nvme_disk_path: '$HOME/.local/share/libvirt/images/' # Some other path in the user's home directory
      nvme_disk_prefix: 'nvme_disk'
      # If true, then append to 'nvme_disk_path' the name of the project.
      append_project_name_to_nvme_disk_path: 'true'
    libvirt_cfg:
      enabled: True # If not true then omit from Vagrantfile
      # Vagrant-Libvirt seems to require a manual step: vagrant box add <BOX> --provider=libvirt
      box: 'generic/ubuntu1804'
      machine_type: 'q35'
      nvme_disk_postfix: 'qcow2'
      nvme_disk_id_prefix: 'drv'
      qemu_group: null # If this is not null, set the group on the storage files to this group
      emulator_path: '/usr/bin/qemu-system-x86_64'
      nvme_disk_path: '$HOME/.local/share/libvirt/images/' # Default to something that works for QEMU://session
      #nvme_disk_path: '/var/lib/libvirt/images/' # Absolute path (for QEMU://sytem)
      #nvme_disk_path: '.vagrant/nvme_disks/' # Relative to the Vagrantfile (requires setting perms)
      # If true, then append to 'nvme_disk_path' the name of the project.
      append_project_name_to_nvme_disk_path: 'true'
      # TO ADD: to Libvirt
      #cdrom:
      #  path: "/data/downloads/win10/Win10_1903_V2_English_x64.iso"
      #usb_passthrough:
      #  bus: 3
      #  device: 10
      #boot:
      #  - "cdrom"
      #  - "hd"
      #kvm_hidden: True
      #video_type: "cirrus"
      #video_vram: 9216
      #cpu_mode: "host-model"

docker:
  enabled: True # If not true then omit from processing
  # build/docker/docker-compose.yml
  compose:
    version: '2'
    services:
      hello_world:
        image: ubuntu
        command: [/bin/echo, 'Hello world']
  # build/docker/.env
  #env:
  #   COMPOSE_PROJECT_NAME=<project_namespace>

ansible:
  roles:
    - name: "ansible-role-mount-disks"
      src: "https://github.com/pwyoung/ansible-role-mount-disks.git"
      scm: "git"
      version: "master"
    - name: "create_partition"
      src: "https://github.com/mcgrof/create_partition.git"
      scm: "git"
      version: "v1.2.1"
  playbooks:
    - name: "ansible-playbook-deploy-kubespray"
      scm: "git"
      src: "https://github.com/pwyoung/ansible-playbook-deploy-kubespray.git"
      version: "master"
      #src: "file:///home/pyoung/git/current/ansible-playbook-deploy-kubespray"
      #version: "dev"
  inventory:
    all:
      vars:
        ansible_python_interpreter: "/usr/bin/python3"
      hosts:
        k-1:
        k-2:
        k-3:
      children:
        kube-master:
          hosts:
            k-1:
            k-2:
        kube-k:
          hosts:
            k-1:
            k-2:
            k-3:
        etcd:
          hosts:
            k-1:
            k-2:
            k-3:
        k8s-cluster:
          children:
            kube-master:
            kube-k:
        calico-rr:
          hosts: {}
  extra_vars:
    # Kubespray generic/download parameters:
    #   Notes:
    #     This has things like helm_version which is not listed in roles/kubernetes-apps/helm/defaults/main.yml
    #   URL:
    #     https://github.com/kubernetes-sigs/kubespray/blob/master/roles/download/defaults/main.yml
    #
    # Helm
    #   https://github.com/kubernetes-sigs/kubespray/blob/master/roles/kubernetes-apps/helm/defaults/main.yml
    helm_enabled: true
    #
    # Local Volumes
    #   https://github.com/kubernetes-sigs/kubespray/tree/master/roles/kubernetes-apps/external_provisioner/local_volume_provisioner
    local_volume_provisioner_enabled: true
    local_volume_provisioner_storage_classes:
      local-storage:
        host_dir: /mnt/disks
        mount_dir: /mnt/disks
    #
    # kubespray_ingress_nginx_enabled
    # dns_cores_per_replica
    # dns_nodes_per_replica
    # populate_inventory_to_hosts_file=false
    # dns_mode
    # cluster_name
    # kube_network_plugin